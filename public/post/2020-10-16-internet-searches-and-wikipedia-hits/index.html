---
title: Internet Searches and Wikipedia Hits
author: ''
date: '2020-10-16'
slug: []
categories:
  - R
  - ggplot2
  - prophet
  - googletrends
tags:
  - analysis
  - R Markdown
---



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Internet search volume and web page hits can provide interesting insights into the collective unconscious (read the minds of bored 20 - somethings on furlough)</p>
<p>This is nice quick introduction to two straight forward packages, <code>googletrendsR</code> and <code>wikipediatrend</code>.</p>
<p>There will also be a cursory flirt with Facebook’s <code>Prophet</code>, a forecasting package.</p>
<p>So lets call in our libraries</p>
<pre class="r"><code>#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
options(scipen = 999)
library(gtrendsR)
library(tidyverse)
library(ggcharts)
library(ggsci)
library(ggthemes)</code></pre>
</div>
<div id="google-trends" class="section level2">
<h2>Google Trends</h2>
<p>The query requires a few different arguments which we can define before hand.
The <code>+</code> between the terms in the keyword vector ensures that those words appear in that order.</p>
<pre class="r"><code>#define the keywords
keywords &lt;- c(&#39;Artificial+neural+network&#39;)
# Choose Location  --------------------------------------------------------
country=c(&#39;GB&#39;)
# Define Time Fram -------------------------------------------------
time_frame = (&quot;2014-01-01 2020-05-30&quot;)
#set channels 
channel=&#39;web&#39;</code></pre>
<p>Here we have the final query, which will return us a <code>list</code> of <code>dataframes</code></p>
<pre class="r"><code>trends  &lt;-  gtrends(keywords, gprop = channel, geo = &#39;GB&#39;, time = time_frame )
str(trends)</code></pre>
<pre><code>## List of 7
##  $ interest_over_time :&#39;data.frame&#39;: 77 obs. of  7 variables:
##   ..$ date    : POSIXct[1:77], format: &quot;2014-01-01&quot; &quot;2014-02-01&quot; ...
##   ..$ hits    : int [1:77] 87 89 89 83 83 82 80 82 86 88 ...
##   ..$ keyword : chr [1:77] &quot;Artificial+neural+network&quot; &quot;Artificial+neural+network&quot; &quot;Artificial+neural+network&quot; &quot;Artificial+neural+network&quot; ...
##   ..$ geo     : chr [1:77] &quot;GB&quot; &quot;GB&quot; &quot;GB&quot; &quot;GB&quot; ...
##   ..$ time    : chr [1:77] &quot;2014-01-01 2020-05-30&quot; &quot;2014-01-01 2020-05-30&quot; &quot;2014-01-01 2020-05-30&quot; &quot;2014-01-01 2020-05-30&quot; ...
##   ..$ gprop   : chr [1:77] &quot;web&quot; &quot;web&quot; &quot;web&quot; &quot;web&quot; ...
##   ..$ category: int [1:77] 0 0 0 0 0 0 0 0 0 0 ...
##  $ interest_by_country: NULL
##  $ interest_by_region :&#39;data.frame&#39;: 4 obs. of  5 variables:
##   ..$ location: chr [1:4] &quot;England&quot; &quot;Scotland&quot; &quot;Wales&quot; &quot;Northern Ireland&quot;
##   ..$ hits    : int [1:4] 100 97 93 80
##   ..$ keyword : Factor w/ 1 level &quot;Artificial + neural + network&quot;: 1 1 1 1
##   ..$ geo     : chr [1:4] &quot;GB&quot; &quot;GB&quot; &quot;GB&quot; &quot;GB&quot;
##   ..$ gprop   : chr [1:4] &quot;web&quot; &quot;web&quot; &quot;web&quot; &quot;web&quot;
##  $ interest_by_dma    : NULL
##  $ interest_by_city   :&#39;data.frame&#39;: 93 obs. of  5 variables:
##   ..$ location: chr [1:93] &quot;Milton Keynes&quot; &quot;Cambridge&quot; &quot;Coventry&quot; &quot;Warrington&quot; ...
##   ..$ hits    : int [1:93] NA 100 92 NA 90 NA NA NA NA 87 ...
##   ..$ keyword : Factor w/ 1 level &quot;Artificial + neural + network&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##   ..$ geo     : chr [1:93] &quot;GB&quot; &quot;GB&quot; &quot;GB&quot; &quot;GB&quot; ...
##   ..$ gprop   : chr [1:93] &quot;web&quot; &quot;web&quot; &quot;web&quot; &quot;web&quot; ...
##  $ related_topics     :&#39;data.frame&#39;: 44 obs. of  6 variables:
##   ..$ subject       : chr [1:44] &quot;100&quot; &quot;22&quot; &quot;21&quot; &quot;12&quot; ...
##   ..$ related_topics: chr [1:44] &quot;top&quot; &quot;top&quot; &quot;top&quot; &quot;top&quot; ...
##   ..$ value         : chr [1:44] &quot;Computer network&quot; &quot;Network Rail&quot; &quot;Rail transport&quot; &quot;Artificial turf&quot; ...
##   ..$ geo           : chr [1:44] &quot;GB&quot; &quot;GB&quot; &quot;GB&quot; &quot;GB&quot; ...
##   ..$ keyword       : chr [1:44] &quot;Artificial+neural+network&quot; &quot;Artificial+neural+network&quot; &quot;Artificial+neural+network&quot; &quot;Artificial+neural+network&quot; ...
##   ..$ category      : int [1:44] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, &quot;reshapeLong&quot;)=List of 4
##   .. ..$ varying:List of 1
##   .. .. ..$ value: chr &quot;top&quot;
##   .. .. ..- attr(*, &quot;v.names&quot;)= chr &quot;value&quot;
##   .. .. ..- attr(*, &quot;times&quot;)= chr &quot;top&quot;
##   .. ..$ v.names: chr &quot;value&quot;
##   .. ..$ idvar  : chr &quot;id&quot;
##   .. ..$ timevar: chr &quot;related_topics&quot;
##  $ related_queries    :&#39;data.frame&#39;: 50 obs. of  6 variables:
##   ..$ subject        : chr [1:50] &quot;100&quot; &quot;66&quot; &quot;50&quot; &quot;33&quot; ...
##   ..$ related_queries: chr [1:50] &quot;top&quot; &quot;top&quot; &quot;top&quot; &quot;top&quot; ...
##   ..$ value          : chr [1:50] &quot;network rail&quot; &quot;how to network&quot; &quot;artificial grass&quot; &quot;wwe network&quot; ...
##   ..$ geo            : chr [1:50] &quot;GB&quot; &quot;GB&quot; &quot;GB&quot; &quot;GB&quot; ...
##   ..$ keyword        : chr [1:50] &quot;Artificial+neural+network&quot; &quot;Artificial+neural+network&quot; &quot;Artificial+neural+network&quot; &quot;Artificial+neural+network&quot; ...
##   ..$ category       : int [1:50] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, &quot;reshapeLong&quot;)=List of 4
##   .. ..$ varying:List of 1
##   .. .. ..$ value: chr &quot;top&quot;
##   .. .. ..- attr(*, &quot;v.names&quot;)= chr &quot;value&quot;
##   .. .. ..- attr(*, &quot;times&quot;)= chr &quot;top&quot;
##   .. ..$ v.names: chr &quot;value&quot;
##   .. ..$ idvar  : chr &quot;id&quot;
##   .. ..$ timevar: chr &quot;related_queries&quot;
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;gtrends&quot; &quot;list&quot;</code></pre>
<p>We can access the elements of the list we would like and assign them to a variable. I have creatively named them as seen below.</p>
<p>The city data seems quite suspect to me and is undoubtedly a case of search locations being grouped to the nearest
‘city’</p>
<pre class="r"><code>time_trend &lt;- trends$interest_over_time

city &lt;- trends$interest_by_city</code></pre>
<div id="process-and-plot" class="section level3">
<h3>Process and plot</h3>
<pre class="r"><code># A little bit of cleaning ------------------------------------------------
library(forcats)
city &lt;- na.omit(city)
# Lets take a look --------------------------------------------------------
ggplot(city, aes( reorder(location, hits), hits)) +
geom_col(fill =&quot;#E69F00&quot;, show.legend = FALSE) +
coord_flip() +
labs(title = &#39;Search Results By Approx Location&#39;,
        y = &#39;Relative Interest&#39;,
        x =&#39;Approx Locations&#39;,
       caption = Sys.Date()) +
theme_hermit()</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>
